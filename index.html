<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Processing Client</title>
</head>
<body>

    <h1>Upload Image for Analysis ðŸ“¸</h1>

    <form id="image-upload-form">
        <label for="image-input">Choose an Image File:</label>
        <input type="file" id="image-input" name="image" accept="image/*" required>
        <button type="submit">Analyze Image</button>
    </form>

    <h2>Results:</h2>
    <pre id="status">Upload an image and click "Analyze Image" to see the results from the backend...</pre>

    <script>
        // --- CONFIGURATION ---
        // IMPORTANT: Change this URL to your actual backend endpoint (e.g., your Python function URL)
        const BACKEND_URL = 'http://your-backend-server.com/api/analyze'; 
        // -----------------------

        const form = document.getElementById('image-upload-form');
        const imageInput = document.getElementById('image-input');
        const statusElement = document.getElementById('status');

        form.addEventListener('submit', async (e) => {
            e.preventDefault(); // Stop the default form submission

            const imageFile = imageInput.files[0];

            if (!imageFile) {
                statusElement.textContent = 'Please select an image file first.';
                return;
            }

            // 1. Prepare the data for sending
            const formData = new FormData();
            // Append the file. 'image' should match the expected field name in your backend function.
            formData.append('image', imageFile); 
            
            // 2. Update status and disable button
            statusElement.textContent = 'Sending image to backend... Please wait.';
            const submitButton = form.querySelector('button[type="submit"]');
            submitButton.disabled = true;

            // 3. Send the request using the Fetch API
            try {
                const response = await fetch(BACKEND_URL, {
                    method: 'POST',
                    // Note: When using FormData, the 'Content-Type' header is usually set automatically 
                    // and should NOT be set manually to 'multipart/form-data' here.
                    body: formData, 
                });

                if (!response.ok) {
                    // Handle HTTP errors (404, 500, etc.)
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                // 4. Get the JSON result (your "results dictionary")
                const resultDict = await response.json();
                
                // 5. Display the results
                statusElement.textContent = JSON.stringify(resultDict, null, 2);
                
            } catch (error) {
                // Handle network errors or errors thrown above
                statusElement.textContent = `ERROR: Failed to connect to or get a valid response from the backend.
                ${error.message}
                
                Ensure your backend server is running and the BACKEND_URL is correct!`;
            } finally {
                // 6. Re-enable the button
                submitButton.disabled = false;
            }
        });
    </script>
</body>
</html>